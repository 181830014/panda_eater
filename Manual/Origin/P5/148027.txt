Due to the use of IProgramElements to create handles (comment #15 of bug 141730) there is a problem with the pointcut used by/uses pointcut relationship. This patch changed places where handles were created for given source locations to first finding the corresponding ipe for the source location within the hierarchy and then creating the handle for this ipe. This works provided the ipe exists in the hierarcy. When it comes to the relationship map all relationships bar the uses pointcut/pointcut used by relationship are created once the hierarchy is built. However, with the uses pointcut/pointcut used by relationship this is added as part of the visitor, namely whilst the hierarchy is being created. If the corresponding pointcut doesn't exist yet then a file node is returned (due to the implementation of AspectJElementHierarchy.findElementForSourceLine(ISourceLocation)) and it is this which is added to the relationship map.

Therefore, we need to investigate moving the creation of this relationship to the place when other relationships are created.