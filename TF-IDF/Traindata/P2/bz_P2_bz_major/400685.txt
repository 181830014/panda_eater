When trying to drop a collection with a native query we ran into this error :
java.lang.ClassCastException: org.eclipse.persistence.nosql.adapters.mongo.MongoPlatform cannot be cast to org.eclipse.persistence.platform.database.DatabasePlatform

The piece of code is the following :
public void cleanAll() throws Exception {
	Query query = _context.getEntityManager().createNativeQuery("db.INVOICE.drop()");
	query.getSingleResult();
	
}