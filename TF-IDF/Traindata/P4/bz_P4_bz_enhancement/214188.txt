I've been trying to use existing action and new task wizards with specialized reporting functionality but apparently the current implementation of NewTaskAction is internal and it also have certain limitations in around supported selection types. So I'd like to suggest some improvements for TasksUiUtil.getSelectedRepository():

- support additional selection types, such as IAdaptable to TaskRepository and/or AbstractTask (to allow 3rd party plugins to adapt their objects to those)
- when selection is empty, can also check if current editor is a Task Editor and use its repository (not really related to my integration, but I think it would be convenient, though Task Editor may have to participate with platfor selection service).

I can submit patch for the adaptables if that would help to get this functionality in Mylyn faster.