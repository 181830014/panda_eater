This is a commands version of bug 355497.

That defect is tracking the non-commands implementation, this one allows us to defer the work on the commands side...